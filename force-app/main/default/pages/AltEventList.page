<apex:page showHeader="false" sidebar="false" standardStylesheets="false" applyHtmlTag="true" controller="AltEventListCtrl">
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com"/>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/>
        <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,800;1,100;1,200;1,300;1,400;1,500;1,800&display=swap" rel="stylesheet"/>
        <title>Novigo | Exam Results</title>
        <style>
            :root {
                --blue-color: #150958;
                --blue-color-hover: #200e89;
                --blue-color-hover-alt: #312a5a;
                --blue-color-select: #534798;
                --text-color: black;
                --background-color: white;
                --red-color: #EF233C;
                --yellow-color: #ffb01d;

                --green-color: #008000;
            }

            * {
                margin: 0;
                padding: 0;
                font-family: 'Poppins', sans-serif;
            }
            input{
                width: 15vw;
                height: 3vh;
                border: 1.5px solid var(--blue-color);
                padding: 2px;
                font-size: 1.25vw;
            }
            textarea{
                width: 15vw;
                height: 10vh;
                border: 1.5px solid var(--blue-color);
                padding: 2px;
                font-size: 1.25vw;
                resize: none;
            }
            .phone-text{
                padding-right: 2px;
                font-size: 1.2vw;
            
                border-right: 1px dashed var(--blue-color);
            }
            input:focus{
                outline: none;
            }
            option{
                color: solid var(--blue-color)!important;
                width: 15vw;
                border: 1.5px solid var(--blue-color);
                background-color: none;

            }

            .phone-container{
                border: 1.5px solid var(--blue-color);
                display: flex;
            }
            .phone-container-error{
                border: 1.5px solid var(--red-color);
            }


            .select-style{
                width: 15.5vw ;
                height: 4vh !important;
                border: 1.5px solid var(--blue-color);
                /* padding-left:2px; */
                padding-right: 2px; 
                background-color: none;
                font-size:1.25vw;

            }
            .input-error{
                border: 1.5px solid var(--red-color);
            }
            .input-warning{
                border: 1.5px solid var(--yellow-color);
            }


            .main {
                height: 100vh;
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .header {
                height: 10vh;
                width: 100%;
                background: var(--blue-color);
                display: flex;
                align-items: center;
                justify-content: space-between
            }

            .novigo-icon {
                height: 6vh;
                margin-left: 8px;
            }
            .novigo-icon-big{
                opacity: 0.05;
                position: fixed;
                bottom: 0;
                right: 0;
                z-index: -1; 
                filter: grayscale(50%);
            }
            .title {
                /* margin-top: 4vh; */
                margin-right:4vh;
                display: flex;
                justify-content: center;
                align-items: center;
                position: sticky;
                top: 0;
                /* background-color: white; */
                z-index: 1;
            }
   

            .title-text {
                font-size: 2vw;
                font-family: 'Poppins', sans-serif;
                font-weight: 500;
                color: var(--background-color);
            }
            .section-body-alt{
                margin-top:4vh;
                background-color: var(--background-color);
                border: 1px solid var(--blue-color);
                border-radius: 8px;
                box-shadow: 0px 1px 10px #150958;
                height: 60%;
            }
            .section-body-green-shadow-alt{
                box-shadow: 0px 1px 10px var(--green-color);
            }
            .section-body-red-shadow-alt{
                box-shadow: 0px 1px 10px var(--red-color);
            }

            .section-wrapper-alt{
                padding: 1.5vh;
                /* margin-top: 2vh; */
                margin-bottom: 2vh;
                

            }
            .section-alt {
                
                padding: 1.5vh;
                /* cursor: pointer; */
                transition: border 0.2s, transform 0.2s;
                width: 40vw;
                max-height: 50vh;

            }

            /* .section:hover {
                border: 2px solid var(--blue-color);
                transform: translateY(-2px);
            } */

            .section-text-container-alt{
                display:flex;
                flex-direction: column;
            }

            .section-text-alt {
                font-weight: 500;
                font-size: 1.5vw;
                margin-left: 1vh;
                margin-bottom: 0.5vh;

            }
            .section-text-small-alt{
                font-weight: 300;
                font-size: 0.8vw;
                margin-left: 1vh;
                margin-bottom: 0.5vh;
                color: var(--red-color);
            }

            .section-items-alt {
                padding: 2vh;
                display: flex;
                flex-direction: column;
                gap: 1.5vh;
            }

            .section-item-alt {
                display: flex;
                justify-content: space-between;
                padding: 1;
                margin: 2vh;
            }

            .section-item-text-alt {
                margin-right: 1vw;
                font-size: 1.2vw;
            }
            .section-buttons-alt{
                display: flex;
                justify-content: space-around;
                flex-direction: row;
            }
            /* .prev-button, .next-button, .go-back-button {
                width: 15rem;
                height: 4rem;
                border-radius: 1rem;
                box-shadow: $shadow;
                justify-self: center;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: .3s ease;
                } */

             .go-back-button {
                background-color: var(--blue-color);
                color: var(--background-color);
                width: 10vw;
                height: 5vh;
                padding: 2px;
                outline: none;
                border: 2px transparent;
                margin: 0.5vw;
                border-radius: 10px;
                cursor: pointer;
                transition: .3s ease;
                }

            .prev-button:hover, .next-button:hover {
                background-color: var(--blue-color-hover);
                }

            .submit-button-alt{
                background-color: var(--green-color);
                color: var(--background-color);
                width: 50%;
                height: 5vh;
                padding: 2px;
                outline: none;
                border:2px transparent;
                margin: 0.5vw;
                border-radius: 10px;
                cursor: pointer;
            }
            /* .prev-button:hover,.next-button:hover {
                background-color: var(--blue-color-hover);
            } */


            .progress-bar {
                width: 100%;
                height: 35px;
                background-color: white;
                position: sticky;
                border-radius: 7px;
                border-bottom-left-radius: 0px;
                border-bottom-right-radius: 0px;
                top: 0;
                z-index: 1;
            }

            .progress {
                height: 100%;
                border-top: 1px solid var(--blue-color);
                display: flex;
                justify-content: flex-start;
                /* border-radius: 7px;
                border-bottom-left-radius: 0px;
                border-bottom-right-radius: 0px; */
                /* background-image: linear-gradient(45deg, var(--blue-color-hover), var(--blue-color-hover-alt)); */
                background-color: var(--blue-color);
                width: 25%;
                clip-path: polygon(0 0, 100% 0, 85% 100%, 0% 100%);
                transition: width 0.5s;
                align-items: flex-end;
            }
            .progress-green {
                background-image: linear-gradient(45deg, var(--green-color), #026d02);
            }
            .progress-red {
                background-image: linear-gradient(45deg, var(--red-color), red);
            }
            .progress-text{
                margin-left: 1vw;
                color: white;
                font-size: 22px;
                font-weight: 400;
            }
            .custom-checkbox{
                width: 20px;
                height: 3vh;
            }
            #successfulSection, #failSection{
                display: none;
            }
            
            .success-section{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }

            .error-image{
                height:18px; 
                width:18px; 
                margin-left:0.5vw;
                margin-right: 1vw;
            }
            .error-alert {
                position: fixed;
                z-index: 1000; 
                top: 8%; 
                left: 50%;
                transform: translate(-50%, -50%);
                display: none;
                padding: 20px;
                border-radius: 10px;
                background-color: var(--red-color);
                color: white;
                margin-bottom: 15px;
                align-items: center;
                justify-content: center;
                align-content: center;
            }
            .alert-animation {
                animation-name: fade;
                animation-duration: 0.5s; /* Adjust the duration as needed */
            }

            @keyframes fade {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }
            .error-warning {
                position: fixed;
                z-index: 1000; 
                top: 8%; 
                left: 50%;
                transform: translate(-50%, -50%);
                display: none;
                padding: 20px;
                border-radius: 10px;
                background-color: var(--yellow-color);
                color: black;
                margin-bottom: 15px;
                align-items: center;
                justify-content: center;
                align-content: center;
            }
            .closebtn {
            margin-left: 15px;
            color: white;
            float: right;
            font-size: 22px;
            line-height: 20px;
            cursor: pointer;
            transition: 0.3s;
            }

            .closebtn:hover {
            color: black;
            }
            .closebtn-black-color{
                color: black;
            }
            .closebtn-black-color:hover{
                color: white;
            }
            ::selection{
                color: white;
                background: var(--blue-color-hover);
            }

            .hide {display: none;}
            .loader {
                display: flex;
                justify-content: center;
                align-items: center;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 9999;
            }

            /* .loader-inner {
                border: 4px solid #f3f3f3;
                border-top: 4px solid #3498db;
                border-radius: 50%;
                width: 100px;
                height: 100px;
                animation: spin 0.5s linear infinite;
            } */
            .loader-logo{
                position: absolute;
                top: 50;
                left: 50;
            }

            .loader-logo .logo-section-one {
                animation: moveOne 1.25s infinite alternate;
            }

            .loader-logo .logo-section-two {
                animation: moveTwo 1.25s infinite alternate;
            }

            @keyframes moveOne {
                0%, 100% {
                    fill: white;
                    transform: translate(-15px, -25px);
                    opacity: 0;
                    
                }
                50% {
                    fill: var(--red-color);
                    transform: translate(0, 0);
                    opacity: 1;
                }
            }

            @keyframes moveTwo {
                0%, 100% {
                    fill: white;
                    transform: translate(10px, 10px);
                    opacity: 0;
                }
                50% {
                    fill: var(--red-color);
                    transform: translate(0, 0);
                    opacity: 1;
                }
            }
            .hidden {
                display: none;
            }

            ::-webkit-scrollbar {
                    width: 12px;
                }

            ::-webkit-scrollbar-track {
                    background-color: rgb(244, 244, 244);
                    /* -webkit-box-shadow: inset 0 0 6px rgba(0, 25, 88, 0.3);  */
                    border-radius: 10px;
                }

            ::-webkit-scrollbar-thumb {
                    border-radius: 10px;
                    background-color: var(--blue-color);
                    transition: 0.3s;
                }
            ::-webkit-scrollbar-thumb:hover {
                    background-color: var(--blue-color-hover);
                }



                body {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    height: 100vh;
                }
                /* input[type=checkbox]{
                    height: 0;
                    width: 0;
                    visibility: hidden;
                } */

                label {
                    cursor: pointer;
                    text-indent: -9999px;
                    width: 4vw;
                    height: 4vh;
                    background: white;
                    display: block;
                    border-radius: 100px;
                    position: relative;
                    border: 2px solid var(--blue-color);
                }

                label:after {
                    content: '';
                    position: absolute;
                    top: 5px;
                    left: 8px;
                    width: 1vw;
                    height: 2vh;
                    background: var(--blue-color);
                    border-radius: 90px;
                    transition: 0.3s;
                }

                input:checked + label {
                    background: var(--blue-color);
                }

                input:checked + label:after {
                    left: calc(100% - 5px);
                    transform: translateX(-100%);
                    background: white;
                }

                label:active:after {
                    background: white;
                    width: 40px;
                }

                .preview-section{
                    display: flex;
                    justify-content: space-between;
                    /* align-items: center; */
                    margin: 1vh;
                    margin-left: 5vw;
                    margin-right: 5vw;
                }
                .previewTitle{
                    color: var(--blue-color);
                    font-size: 1.25vw;
                    margin-left: 2vw;

                }
                .previewValue{
                    color: var(--blue-color);
                    font-size: 1.25vw;
                    font-weight: 500;
                    margin-left: 1vw;
                    margin-right: 2vw;
                }
            
                .details-summary{
                    display: flex;
                    flex-direction: column;
                    overflow-y: scroll;
                    max-height: 60vh;
                }
                
                        
                .login-nav{
                    display:grid;
                    place-items:center;
                    text-decoration: underline;
                    color: var(--blue-color);
                    font-size: 12px;
                    margin-top: 10px;
                    cursor: pointer
                }



                .content-containeralt {  
                  /* height: 100%;
                  width: 100vw; */
                }

                .section-item-text {
                margin-right: 1vw;
                font-size: 1.2vw;
                }
                .select-style{
                    width: auto;
                    height: 4vh !important;
                    border: 1.5px solid var(--blue-color);
                    /* padding-left:2px; */
                    padding-right: 2px; 
                    background-color: none;
                    font-size:1.25vw;
                    border-radius: 5px;
                    cursor: pointer;

                }

                .section-item-1{ 
                    margin-top: -5vh;
                    display: grid;
                    align-items: center;
                    justify-content: left; 
                }
                .section-item-2{   
                    height: 8vh; 
                    display: none;
                    place-items: center;
                    grid-template-columns: 1fr 1fr 1fr 42vw;
                    
                    width: 100%;
                                    
                }

                .section-item-3{
                    display: grid;
                    place-items:center; 
                }

                .section-item-3-table{
                    width: 98vw;
                    box-shadow: 0px 1px 10px #150958;
                    height: 71vh;
                    border-radius: 5px;
                    
                }
        
                .section-item-4{
                    display: flex;
                    justify-content: right;
                    align-items: center;
                    margin-right: 4vw;
                    height: 15vh;
                }
                .section-item-3-table-item-heder{
                    background: var(--blue-color);
                    border-top-left-radius: 5px;
                    border-top-right-radius: 5px;
                    height: 8vh;
                    display: flex;
                    width: 100%;
                    color: white;
                    display: grid;
                    place-items: center;
                    grid-template-columns: 3vw 14vw 23vw 10vw 12vw 11vw 11vw 14vw;
                }

                .section-item-3-table-item-heder-row{
                    display: grid;
                    place-items:center; 
                    grid-template-columns: 1fr 3vw;
                }
                .section-item-3-table-item-heder-row-new{
                    grid-template-columns: 1fr;
                }

                .section-item-3-table-item-body{
                    overflow: scroll;
                    height: 63vh;
                    overflow-x: hidden;
                }
                .section-item-3-table-item-body-row{
                    border-bottom: 1px solid rgb(194, 194, 194);
                    display: grid;
                    place-items: center;
                    grid-template-columns: 3vw 14vw 23vw 10vw 12vw 11vw 11vw 14vw;
                    min-height: 6vh;
                }
                .section-item-3-table-item-body-row-item-1,
                .section-item-3-table-item-body-row-item-2,
                .section-item-3-table-item-body-row-item-3,
                .section-item-3-table-item-body-row-item-4,
                .section-item-3-table-item-body-row-item-5,
                .section-item-3-table-item-body-row-item-6{
                            display: grid;
                            place-items:center;
                }
                .section-item-3-table-item-body-row-item-1,
                .section-item-3-table-item-body-row-item-2,
                .section-item-3-table-item-body-row-item-3{
                  padding: 8px;
                }
                .section-item-3-table-item-body-row-item-7{
                    display: grid;
                    grid-template-columns: 1fr;
                    place-items:center;
                }
                .go-back-button:hover{
                    box-shadow: 0px 0px 10px #150958;
                }
    
                .go-back-button:active{
                    box-shadow: 0px 0px 30px #150958;
                }

                .slect-students-checkbox-class{
                    height: 3vh;
                    width: 2vw; 
                }

                .section-item-3-table-item-body-init{
                    height: 100%;
                    display: grid;
                    place-items:center;
                }


                .btn-round-view{
                    background-color: var(--blue-color);
                    color: var(--background-color);
                    width: 9vw;
                    height: 5vh;
                    padding: 0px 4px;
                    outline: none;
                    border: 2px transparent;
                    margin: 0.5vw;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: .3s ease;
                    display: grid;
                    place-items: center;
                }

                .btn-round-view:hover{
                    box-shadow: 0px 0px 10px #150958;
                }

                .btn-round-view:active{
                    box-shadow: 0px 0px 30px #150958;
                }

                .section-item-3-table-item-heder-row-search-inp{
                    border-radius: 5px;
                    height: 3.5vh;
                    margin-right: 1vw; 
                    padding-left: 1vw;
                }

                .search-inp-button{
                    width: 9vw;
                    height: 4.5vh;
                    border-radius: 10px;
                    border: none;
                    font-weight: 600;
                    background: #e1dede;
                    font-size: 1rem;
                }

               .search-inp-button:hover{
                    box-shadow: 0px 0px 10px #150958;
                }

               .search-inp-button:active{
                    box-shadow: 0px 0px 30px #150958;
                }

                body{
                    position: relative;
                }


                .student-info-popup{ 
                    position: absolute;
                    z-index: 10;
                    height: 100vh;
                    width: 100vw;
                    background: #000000ed;
                    display: grid;
                    place-items:center;
                    
                }
                .student-info-popup-body{
                    min-height: 40vh;
                    width: 54vw;
                    background: white;
                    border-radius: 20px;
                    max-height: 80vh;
                    overflow: scroll;
                    overflow-x: hidden; 
                }

                .student-info-popup-body::-webkit-scrollbar {
                    display: none;
                }




                .student-info-popup-body-header{
                    display: grid;
                    justify-content: right;
                    align-items: center;
                    height: 8vh;
                    padding-right: 1vw;
                }


                .div-btn-red{
                    background: var(--red-color);
                    color: white; 
                    text-align: center;
                    border-radius: 5px; 
                    cursor: pointer;
                    padding: 0.3vh 0.8vw;
                }

                .div-btn-blue{
                    background: var(--blue-color);
                    color: white; 
                    text-align: center;
                    border-radius: 5px; 
                    cursor: pointer;
                    padding: 0.3vh 0.8vw;
                }


                .div-btn-red:hover{
                    box-shadow: 0px 0px 10px #c90606;
                }

                .div-btn-red:active{
                    box-shadow: 0px 0px 30px #c90606;
                }

                .student-info-popup-body-cnt-pan{
                    display: flex;
                    width: 50vw;
                    margin: auto auto;
                    display: grid;
                    height: 10vh;
                    grid-template-columns: 1fr 1fr 1fr;
                }
                .student-info-popup-body-cnt-pan-txt{
                    display: grid;
                    place-items:center;
                }

                .student-info-popup-body-cnt-pan-dropdown{
                    display: grid;
                    place-items:center; 
                }

                .student-info-popup-body-cnt-pan-assign{
                    display: grid;
                    place-items: center;
                    grid-template-columns: 6vw 8vw;
                    margin: auto;
                }

                .student-info-popup-body-cnt-pan-addmore{
                    width: 14vw;
                    margin: auto;
                }

                .div-btn-blue:hover{
                    box-shadow: 0px 0px 10px #150958;
                }

               .div-btn-blue:active{
                    box-shadow: 0px 0px 30px #150958;
                }

                .student-info-popup-body-cnt-pan-addmore-cnt{
                    display: grid;
                    height: 6vh;
                    grid-template-columns: 11vw 1fr; 
                }

                .student-info-popup-body-cnt-pan-addmore-cnt-txt{
                    display: grid;
                    place-items:center;
                }


                .student-info-popup-body-cnt-pan-addmore-cnt-icon{
                    display: grid;
                    place-items: center;
                    height: 5vh;
                    width: 5vh;
                    background: grey;
                    border-radius: 50%;
                    margin: auto;
                    font-size: 1.4rem;
                    font-weight: 500;
                    cursor: pointer;
                }


                .student-info-popup-body-cnt-pan-addmore-cnt-icon:hover{
                    box-shadow: 0px 0px 10px #150958;
                }

               .student-info-popup-body-cnt-pan-addmore-cnt-icon:active{
                    box-shadow: 0px 0px 30px #150958;
                }


                .student-info-popup-body-cnt-pan-assign-btn{
                    display: grid;
                    place-items: center;
                    grid-template-columns: 1fr 1fr;
                    width: 30vw;
                    margin: auto;
                    margin-top: 7vh;
                    margin-bottom: 3vh;
                }

                .div-btn-blue-btn{
                         width: 10vw;
                }
                




                .student-info-popup-hide{
                   display: none;
                }

                .section-item-2-search{
                    height: 9vh;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .section-item-2-search-btns{
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .print-all-btns{
                    background-color: var(--blue-color);
                    color: var(--background-color); 
                    height: 5vh;
                    padding: 2px 8px;
                    outline: none;
                    border: 2px transparent;
                    margin: 0.5vw;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: .3s ease;
                }


                .student-info-popup-body-stud-info{
                    display: grid;
                    grid-template-columns: 1fr 1fr 1fr;
                    place-items: center;
                    min-height: 5vh;
                    border: 2px solid rgb(165, 164, 164);
                    margin: 0 1vw;
                    border-radius: 5px;
                }

                

                .success-section{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }

            .error-image{
                height:18px; 
                width:18px; 
                margin-left:0.5vw;
                margin-right: 1vw;
            }
            .error-alert {
                position: fixed;
                z-index: 1000; 
                top: 8%; 
                left: 50%;
                transform: translate(-50%, -50%);
                display: none;
                padding: 20px;
                border-radius: 10px;
                background-color: var(--red-color);
                color: white;
                margin-bottom: 15px;
                align-items: center;
                justify-content: center;
                align-content: center;
            }

            .sucess-alert {
                position: fixed;
                z-index: 1000; 
                top: 8%; 
                left: 50%;
                transform: translate(-50%, -50%);
                display: none;
                padding: 20px;
                border-radius: 10px;
                background-color:  var(--green-color);
                color: white;
                margin-bottom: 15px;
                align-items: center;
                justify-content: center;
                align-content: center;
            }
            .alert-animation {
                animation-name: fade;
                animation-duration: 0.5s; /* Adjust the duration as needed */
            }

            @keyframes fade {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }
            .error-warning {
                position: fixed;
                z-index: 1000; 
                top: 8%; 
                left: 50%;
                transform: translate(-50%, -50%);
                display: none;
                padding: 20px;
                border-radius: 10px;
                background-color: var(--yellow-color);
                color: black;
                margin-bottom: 15px;
                align-items: center;
                justify-content: center;
                align-content: center;
            }
            .closebtn {
            margin-left: 15px;
            color: white;
            float: right;
            font-size: 22px;
            line-height: 20px;
            cursor: pointer;
            transition: 0.3s;
            }

            .closebtn:hover {
            color: black;
            }
            .closebtn-black-color{
                color: black;
            }
            .closebtn-black-color:hover{
                color: white;
            }
            ::selection{
                color: white;
                background: var(--blue-color-hover);
            }

                @media print {
                @page {
                    margin-left: 0.5in;
                    margin-right: 0.5in;
                    margin-top: 0;
                    margin-bottom: 0;
                }


                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.7);
                }

                .close {
                    color: #888;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    cursor: pointer;
                }
}





           .sort-icon{
            height: 2vh;
            
           }

           .hide-name-down-icon{
            display: none;
           }

           #student-count-id{
            padding: 0 1vw 0 1vw;
           }


           .view-all-promoted-students{
                display: grid;
                grid-template-columns: 2vw 1fr;
                place-items:center; 
            }

            .input-all-promoted-std{
                width: 3vw;
            }

            input[type=checkbox]{
                accent-color: #150985;
            }

            .reset-test-btns{
                display: flex;
                margin-left: 20vw;
            }

            .admin-button{
                    display: none;
                    place-items: center;
                }

                .refresh-btn{
                    background: white;
                    color: #150958;
                    font-weight: 700;
                    font-size: 1rem;
                }

                .header-btns{
                    display: flex;
                }


    </style>
   

    
    </head>
    <body>
        <div class="loader hidden">
            <div class="loader-logo loader-logo-animation">
                <svg width="120" height="120" viewBox="0 0 61 51" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M30.8919 50.5334C33.472 46.3136 35.8983 42.4107 38.2198 38.4516C38.447 38.062 38.1813 37.2563 37.8911 36.7808C30.6681 24.8707 23.4241 12.9705 16.1242 1.10328C15.7781 0.541945 14.9355 0.0697652 14.2502 0.0565574C9.65982 -0.0325952 5.0659 0.0103303 0 0.0103303C10.3486 16.9361 20.5293 33.5845 30.8919 50.5334Z" fill="white"/>
                    <path class="logo-section-one" d="M21.9257 0.0785001C28.4739 10.7867 34.8054 21.135 41.3047 31.7607C43.8779 27.5738 46.3182 23.6643 48.6536 19.7053C48.8844 19.3123 48.6641 18.5133 48.3844 18.0444C44.9897 12.4146 41.567 6.80127 38.0743 1.22428C37.7422 0.692662 36.8996 0.137935 36.2843 0.124727C31.6869 0.0322727 27.0825 0.0751975 21.9257 0.0751975V0.0785001Z" fill="#EF233C"/>
                    <path class="logo-section-two" d="M60.6489 0.124756H45.0002C47.6293 4.4404 50.1395 8.56784 52.7965 12.9264C55.4326 8.62727 57.9394 4.54276 60.6489 0.124756Z" fill="#EF233C"/>
                </svg>
            </div>
            <div class="loader-inner"></div>
        </div>
        <div class="error-warning" id="warningCustom">
            <img id="warnImg" src="{!URLFOR($Resource.iconAlertBlack)}" class="error-image"/>
            <span id="warnText" class="closebtn closebtn-black-color"  onclick="this.parentElement.style.display='none';">&times;</span>
        </div>
        <div class="error-alert" id="errorCustom">
            <img id="alertImg" src="{!URLFOR($Resource.iconAlertWhite)}" class="error-image"/>
            <span id="alertText" class="closebtn"  onclick="this.parentElement.style.display='none';">&times;</span>
        </div>
            
      
        <div class="main">
            <div class="error-warning" id="warningCustom">
                <img id="warnImg" src="{!URLFOR($Resource.iconAlertBlack)}" class="error-image"/>
                <span id="warnText" class="closebtn closebtn-black-color"  onclick="this.parentElement.style.display='none';">&times;</span>
            </div>
            <div class="error-alert" id="errorCustom">
                <img id="alertImg" src="{!URLFOR($Resource.iconAlertWhite)}" class="error-image"/>
                <span id="alertText" class="closebtn"  onclick="this.parentElement.style.display='none';">&times;</span>
            </div>
            <div class="sucess-alert" id="sucessCustom">
                <img id="alertImg" src="{!URLFOR($Resource.iconAlertWhite)}" class="error-image"/>
                <span id="alertText" class="closebtn"  onclick="this.parentElement.style.display='none';">&times;</span>
            </div>

            <div class="header">
                <div>
                    <img  class="novigo-icon" src="{!URLFOR($Resource.novigo_logo)}" alt="Novigo Icon"/>
                </div>
                <div class="header-btns">
                    <div class="section-buttons" >
                        <button class="print-all-btns refresh-btn" onclick="RefreshBtn()" >Refresh data</button>
                    </div>  
                    <div class="title" id='downloadPdfButton'>
                        <svg style="margin-right: 1vw;" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="white" d="M11 9c0 1.66-1.34 3-3 3s-3-1.34-3-3s1.34-3 3-3s3 1.34 3 3m3 11H2v-2c0-2.21 2.69-4 6-4s6 1.79 6 4m8-6v2h-9v-2m9-4v2h-9V8m9-4v2h-9V4Z"/></svg>
                        <span class="title-text" id="pageHeader">Round One Results  </span>
                    </div>
                </div>
            </div> 
            <div class="content-containeralt"> 
                <div class="main-dropdown-cont">
                    <!-- <div class="section-item-1">
                        <span class="section-item-text">Select An Round To Assign:</span>
                        <select class="select-style" style="width:16vw" id="RoundDropDown" >
                            <option  value="invalid" disabled="disabled" selected="selected">Select Round Name</option>
                        </select>
                    </div> -->
                    <div class="section-item-2">   

                        <div class="section-item">
                            <input oninput="GetStudentsDataFn()" placeholder="Enter Student Total Marks" type="number" class="section-item-3-table-item-heder-row-search-inp admin-button"  id="StudentTotalMarksInp"  /> 
                        </div>
                        <div class="section-item">
                            <input oninput="GetStudentsDataFn()" placeholder="Enter Student C - Marks" type="number" class="section-item-3-table-item-heder-row-search-inp admin-button"  id="StudentCMarksInp"  /> 
                        </div>
                        <div class="section-item">
                            <input oninput="GetStudentsDataFn()" placeholder="Enter Student Count" type="number" class="section-item-3-table-item-heder-row-search-inp admin-button"  id="StudentCountInp"  /> 
                        </div> 
                        <div class="reset-test-btns">

                            <div class="section-buttons" >
                                <button class="print-all-btns admin-button" onclick="ResetAllStudentsFn()" >Reset All Tests</button>
                            </div>                      
                            <div class="section-buttons" >
                                <button class="print-all-btns admin-button"  onclick="compileTest()">Resubmit All Tests</button>
                            </div> 
                        </div>
                    </div>
                    <div class="section-item-2-search">
                        <div class="section-item-2-search-btns">
  
                            <div class="section-buttons" >
                                <button class="print-all-btns admin-button" onclick="exportToExcel()"  >Generate Excel</button>
                            </div> 
                            <div class="section-buttons" >
                                <button class="print-all-btns admin-button" onclick="DemoteStudentsFromRound2()" >Demote Selected Students</button>
                            </div> 
                            <div class="section-buttons" >
                                <button class="print-all-btns admin-button" onclick="PromoteStudentsToRound2()" >Promote Selected Students</button>
                            </div> 
                            <div class="section-buttons" id = 'student-count-id' >
                                
                            </div>
                            <div class="section-buttons" >
                                <div class="view-all-promoted-students admin-button">
                                    <div>
                                        <input onchange="veiw_all_promoted_students(this)" id = 'input-all-promoted-std-id' class="input-all-promoted-std" type="checkbox"/>
                                    </div>
                                    <div>View All Promoted Students</div>
                                </div>
                                <div class="view-all-promoted-students admin-button">
                                    <div>
                                        <input onchange="veiw_all_approved_students(this)" id = 'input-all-approved-std-id' class="input-all-promoted-std" type="checkbox"/>
                                    </div>
                                    <div>View All Approved Students</div>
                                </div>
                            </div> 
                        </div>  
                        <div>
                            <input oninput="SearchStudentFn()" placeholder="Search Student" type="text" class="section-item-3-table-item-heder-row-search-inp"  id="section-item-3-table-item-heder-row-search-inp-id"  />
                        </div>
                    </div>
                    <div class="section-item-3">
                              <div class="section-item-3-table">    
                                    <div class="section-item-3-table-item-heder">
                                        <div class="section-item-3-table-item-heder-row-new-check" > 
                                            <input type="checkbox" id='main-check-box' onchange="check_all_student(this)"/>
                                        </div>
                                          <div class="section-item-3-table-item-heder-row">
                                            <div>Name</div>
                                            <div  id = 'name-up'>
                                                <img title="Click To Sort The List Descending By Name" onclick="SortArrowClick('up','name')" class="sort-icon" src="{!URLFOR($Resource.UpArrow)}" alt="Novigo Icon"/>
                                            </div>
                                            <div  id = 'name-down'>
                                                <img  title="Click To Sort The List Ascending By Name" onclick="SortArrowClick('down','name')" class="sort-icon" src="{!URLFOR($Resource.DownArrow)}" alt="Novigo Icon"/>
                                            </div>
                                         </div>
                                          <div class="section-item-3-table-item-heder-row section-item-3-table-item-heder-row-new">Email</div>
                                          <div class="section-item-3-table-item-heder-row section-item-3-table-item-heder-row-new">USN</div>
       
                                          <div class="section-item-3-table-item-heder-row">
                                            <div> Total Marks</div>
                                            <div id = 'total-marks-up' >
                                                <img onclick="SortArrowClick('up','total-marks')"  class="sort-icon" src="{!URLFOR($Resource.UpArrow)}" alt="Novigo Icon"/>
                                            </div>
                                            <div id = 'total-marks-down'>
                                                <img onclick="SortArrowClick('down','total-marks')"   class="sort-icon" src="{!URLFOR($Resource.DownArrow)}" alt="Novigo Icon"/>
                                            </div>
                                         </div>
                                         <div class="section-item-3-table-item-heder-row">
                                            <div> C - Marks</div>
                                            <div id = 'c-marks-up'>
                                                <img  onclick="SortArrowClick('up','c-marks')"  class="sort-icon" src="{!URLFOR($Resource.UpArrow)}" alt="Novigo Icon"/>
                                            </div>
                                            <div id = 'c-marks-down'>
                                                <img onclick="SortArrowClick('down','c-marks')"   class="sort-icon " src="{!URLFOR($Resource.DownArrow)}" alt="Novigo Icon"/>
                                            </div>
                                         </div>
                                         <div class="section-item-3-table-item-heder-row">
                                            <div> Apti - Marks</div>
                                            <div id = 'apti-marks-up'>
                                                <img  onclick="SortArrowClick('up','apti-marks')"  class="sort-icon" src="{!URLFOR($Resource.UpArrow)}" alt="Novigo Icon"/>
                                            </div>
                                            <div id = 'apti-marks-down'>
                                                <img onclick="SortArrowClick('down','apti-marks')"   class="sort-icon " src="{!URLFOR($Resource.DownArrow)}" alt="Novigo Icon"/>
                                            </div>
                                         </div>
                                         <div class="section-item-3-table-item-heder-row-new">
                                            <div id="ResetApproveViewButton"> Reset | Approve | View</div> 
                                         </div>
                                    </div>
                                    <div class="section-item-3-table-item-body"> 
                                        <div class="section-item-3-table-item-body-init">
                                            No Students Selected.
                                        </div>
                                    </div> 
                              </div>
                    </div>
                    
                </div>

            </div>
            
        </div>
        <div>
            <img class="novigo-icon-big" src="{!URLFOR($Resource.novigo_logo_blue)}" alt="Novigo Icon"/>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

        <script>

            function CL(log_val){
                console.log(log_val);
            }


           var currentStudentTestToUpdate = '';
           var currentPanelistToUpdate = '';
           var currrentRoundNumber = 0;
           var studentAssessmentsMap;


           //Runs Onload
           var panelistsID = getUrlParameter('panelistId');
           if(panelistsID)
           {
               document.getElementById('pageHeader').innerHTML = 'Students For interview.'
               document.getElementById('main-check-box').style.display = 'none';
           }



          


 

            function showLoader() {
                document.querySelector(".loader").classList.remove("hidden");
            }
    
            function hideLoader() {
                document.querySelector(".loader").classList.add("hidden");
            }
  

              function getUrlParameter(name) {
                        const urlParams = new URLSearchParams(window.location.search);
                        return urlParams.get(name);
              }

             const eventID = getUrlParameter('eventID');
             if(!eventID){
                routeToAdminLogin();
             }

             function routeToAdminLogin()
             {
                var targetPageUrl = '/apex/AdminLogin';
                window.location.href = targetPageUrl;
             }



              showLoader(); 


            var curInputSearchValue = '';
            const inputElement = document.getElementById('section-item-3-table-item-heder-row-search-inp-id');

            inputElement.addEventListener('input', function() {
                curInputSearchValue = inputElement.value; 
            });
 
            var GlobalAllStudList;
 
            var GlobStudList;
 

            var addMoreBtnClickedFlag = false;


            function routeToStudentPage(eventId,studentId) {
                var panelID = getUrlParameter('panelistId');
                var adminId = getUrlParameter('adminId');
                var directorId = getUrlParameter('DirectorId');
                var targetPageUrl = '';

                if(panelID != null)
                {
                    targetPageUrl = '/apex/studentProfile?eventId=' + eventId  + '&studentId=' + studentId + '&panelistId=' + panelID;
                }
                else if(adminId != null)
                {
                    targetPageUrl = '/apex/studentProfile?eventId=' + eventId  + '&studentId=' + studentId + '&adminId=' + adminId;
                }
                else
                {
                    targetPageUrl = '/apex/studentProfile?eventId=' + eventId  + '&studentId=' + studentId + '&DirectorId=' + directorId;
                }
                window.location.href = targetPageUrl;
                
          }

           function RoundClick(ele,btn_num){
                  if(btn_num === 4){ 
                    var student_id = ele.getAttribute('data-custom-student_id');
                    routeToStudentPage(eventID,student_id);
                  }

                  if(btn_num === 1)
                  {
                    var eventId = getUrlParameter('eventID');
                    var student_id = ele.getAttribute('data-custom-student_id');
                    resetStudent(student_id,eventID);
                  }

                  if(btn_num === 2)
                  {
                    var eventId = getUrlParameter('eventID');
                    var studentTestId = ele.getAttribute('data-custom-value');
                    changeApproval(studentTestId,eventID,true,ele);


                  }
                  if(btn_num === 3)
                  {
                    var eventId = getUrlParameter('eventID');
                    var studentTestId = ele.getAttribute('data-custom-value');
                    changeApproval(studentTestId,eventID,false,ele);

                  }
           }

           
            function initTable(result,filter_student_to_display){
                console.log('initTable')
                
                console.log(result); 
                document.getElementById('student-count-id').textContent = 'Student Count : '+ result.length;
                var main_body_remove = document.querySelector('.section-item-3-table-item-body');
                while (main_body_remove.firstChild) {
                    main_body_remove.removeChild(main_body_remove.firstChild);  
                }
                var panelID = getUrlParameter('panelistId');

                
                for(var i = 0 ; i< result.length; i++){
                            if(!panelID)
                            {   
                                // if( !filter_student_to_display && (result[i].round_one_cleared__c == true || result[i].isApproved__c ==true)) continue;
                            }
                            
                            var main_body = document.querySelector('.section-item-3-table-item-body');
                            var main_ele = document.createElement('div');
                            main_ele.className = 'section-item-3-table-item-body-row';
                            main_ele.id = 'section-item-3-table-item-body-row-'+result[i].Id;
                            if(result[i].round_one_cleared__c && !panelID){
                                main_ele.style.background = '#cbc9ff';
                            }

                            
                            if(result[i].isApproved__c && !panelID){
                                main_ele.style.background = '#baffba';
                            }

                            interviewResult = checkIfInterviewDone(result[i].Id);
                            if(interviewResult)
                            {
                                switch(interviewResult)
                                {
                                    case 'Approved':
                                    main_ele.style.background = '#baffba';
                                    break;

                                    case 'Rejected':
                                    main_ele.style.background = '#ff7979';
                                    break;

                                    case 'On-Hold':
                                    main_ele.style.background = '#ffb01d';
                                    break;
                                        
                                }
                            }

                            var ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-check';
                            var inp_checkbox = document.createElement('input');
                            inp_checkbox.setAttribute('type','checkbox');
                            inp_checkbox.id = 'check-'+result[i].Id;
                            inp_checkbox.setAttribute("data-custom-value",result[i].Id); 

                            if(panelID)
                            {
                                inp_checkbox.style.display = 'none';
                            }
                            inp_checkbox.onchange = function (){
                                check_single_student(this);
                            }
                            ele.appendChild(inp_checkbox);

                            

                            main_ele.appendChild(ele);
                            
                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-1';
                            ele.textContent =  result[i].student_id__r.Name;
                            main_ele.appendChild(ele);


                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-2';
                            ele.textContent = result[i].student_id__r.email__c;
                            main_ele.appendChild(ele); 


                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-3';
                            ele.textContent = result[i].student_id__r.usn__c !== undefined ?  result[i].student_id__r.usn__c : 'NaN';
                            main_ele.appendChild(ele); 

                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-4';
                            ele.textContent =   result[i].student_marks_scored__c;
                            main_ele.appendChild(ele); 

                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-5';
                            ele.textContent =   result[i].student_cprogram_marks__c;
                            main_ele.appendChild(ele);
                            
                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-6';
                            ele.textContent =   result[i].student_apti_marks__c;
                            main_ele.appendChild(ele);

                            ele = document.createElement('div');
                            ele.className = 'section-item-3-table-item-body-row-item-7';
                        

                            btnele = document.createElement('div');
                            btnele.className = 'btn-round-view';
                            btnele.textContent =   '↻';
                            btnele.style.background = '#c10909';
                            btnele.style.fontSize = '20px';
                            btnele.style.width = '2vw';
                            btnele.id = 'reset-'+result[i].Id;
                            btnele.setAttribute("data-custom-value",result[i].Id);
                            btnele.setAttribute("data-custom-student_id",result[i].student_id__c);
                            var curStudID = result[i].student_id__c; 
                            btnele.onclick = function (){
                                RoundClick(this,1);
                            };
                            ele.appendChild(btnele); 

        

                            btnele = document.createElement('div');
                            btnele.className = 'btn-round-view';
                            btnele.textContent =   '✔️';
                            btnele.style.background = '#150958';
                            btnele.style.width = '2vw';
                            if(result[i].isApproved__c){
                                btnele.style.display = 'none';
                            }else{
                                btnele.style.display = 'grid';
                                if(result[i].round_one_cleared__c){
                                    btnele.style.pointerEvents = 'none';
                                }
                            }
                            btnele.id = 'approve-'+result[i].Id;
                            btnele.setAttribute("data-custom-value",result[i].Id);
                            
                            btnele.onclick = function (curStudID){
                                RoundClick(this,2);
                            }; 

                            ele.appendChild(btnele); 

                            
                            btnele = document.createElement('div');
                            btnele.className = 'btn-round-view';
                            btnele.textContent =   '❌';
                            btnele.style.background = '#150958';
                            btnele.style.width = '2vw'; 
                            if(result[i].isApproved__c){
                                btnele.style.display = 'grid';
                            }else{
                                btnele.style.display = 'none';
                            }
                            btnele.id = 'remove-approve-'+result[i].Id;
                            btnele.setAttribute("data-custom-value",result[i].Id);
                            
                            btnele.onclick = function (curStudID){
                                RoundClick(this,3);
                            }; 
                            ele.appendChild(btnele);

                            
                            btnele = document.createElement('div');
                            btnele.className = 'btn-round-view';
                            btnele.textContent =   '↗';
                            btnele.style.background = '#150958';
                            btnele.style.width = '2vw';
                            btnele.setAttribute("data-custom-value",result[i].Id);
                            btnele.setAttribute("data-custom-student_id",result[i].student_id__c);
                            btnele.onclick = function (curStudID){
                                RoundClick(this,4);
                            }; 
                            ele.appendChild(btnele);


                            
                            main_ele.appendChild(ele); 
                            main_body.appendChild(main_ele);

                            var adminId = getUrlParameter('adminId');
                            var directorId = getUrlParameter('DirectorId');
                            if(adminId || directorId){
                                ele.style.gridTemplateColumns = "1fr 1fr 1fr";
                            }
                    
                } 

               
                document.getElementById("ResetApproveViewButton").innerHTML = 'Take Interview';

                var adminId = getUrlParameter('adminId');
                // console.log(adminId);

                if(adminId || directorId)
                {
                    showAdminButton();        
                }
                var panelID = getUrlParameter('panelistId');
                if(panelID){
                    showPanBtns();
                }

            }

            function showPanBtns(){
                for(let i = 0 ; i < GlobStudList.length ;i++){ 
                    document.getElementById('approve-'+GlobStudList[i].Id).style.display = 'none';
                    document.getElementById('remove-approve-'+GlobStudList[i].Id).style.display = 'none'; 
                    document.getElementById('reset-'+GlobStudList[i].Id).style.display = 'none'; 
                }
            }

            function showAdminButton()
            {
                var adminAccessableButtons =  [];
                adminAccessableButtons = document.querySelectorAll('.admin-button');

                for(var i = 0; i < adminAccessableButtons.length; i++)
                {
                    adminAccessableButtons[i].style.display = 'grid';
                }

                document.getElementById('ResetApproveViewButton').innerHTML = 'Reset | Approve | View';
                document.querySelector('.section-item-2').style.display = 'grid';
            }

            InitDataFn();

            function InitDataFn(){ 
                var panelID = getUrlParameter('panelistId');
                
                panelID = panelID ? panelID : '';
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.AltEventListCtrl.GetStudentsData}',
                            panelID,eventID,
                                function (result, event) {
                                            // console.log("success"); 
                                            hideLoader(); 
                                            GlobStudList = result;
                                            GlobalAllStudList = result;
                                            initTable(result,false);
                                            console.log(panelID);
                                            if(panelID)
                                            {
                                                
                                                getStudentAssessment(GlobStudList);
                                            }
                                            
                                            var adminId = getUrlParameter('adminId');
                                            if(adminId)
                                            {
                                               
                                            }
                                        }
                    ); 
            }
 
            function displayErrorMessage(errorText) {
                const errorCustom = document.getElementById("errorCustom");
                const alertText = errorCustom.querySelector("#alertText");
                const alertImg = errorCustom.querySelector("#alertImg");
                errorCustom.textContent = "";
                errorCustom.appendChild(alertImg);
                errorCustom.appendChild(document.createTextNode("Error: " + errorText));
                errorCustom.appendChild(alertText);
    
                errorCustom.style.display = 'flex';
                errorCustom.classList.add("alert-animation");
                setTimeout(() => {
                    errorCustom.style.display = "none";
                    errorCustom.classList.remove("alert-animation");
                }, 5000);
            }
    
            function displayWarningMessage(warningText) {
                const warningCustom = document.getElementById("warningCustom");
                const warnText = document.getElementById("warnText"); // Get the warnText element
                const warnImg = document.getElementById("warnImg"); // Get the warnImg element
    
                warningCustom.textContent = ""; // Clear any existing content
                warningCustom.appendChild(warnImg);
    
                // Create a text node and set its content
                const warningTextNode = document.createTextNode("Warning: " + warningText);
                warningCustom.appendChild(warningTextNode);
    
                warningCustom.appendChild(warnText); // Append the warnText element
    
                warningCustom.style.display = 'flex';
                // warningCustom.classList.add("alert-animation");
                setTimeout(() => {
                warningCustom.style.display = "none";
                    warningCustom.classList.remove("alert-animation");
                }, 5000);
            }
    
            function routeToAdminPage(loginDetails) {
                var targetPageUrl;
                //assiging ID as per login
                if(loginDetails.isAdmin)
                {
                    targetPageUrl = '/apex/adminPage?adminId=' + loginDetails.recordID;
                }
                else
                {
                    targetPageUrl = '/apex/adminPage?panelistId=' + loginDetails.recordID;
                }

                window.location.href = targetPageUrl;
                
            }


            function NavToLoginPage(){
                var targetPageUrl = '/apex/studentRegistrationAlt';
                window.location.href = targetPageUrl;
            }
    
             
    
 

             var StudentsFromDataBase;

             var StudentSort  = 'Name ASC';

             function GetStudentsDataFn(){  
                const StudentCountInp = document.getElementById("StudentCountInp");
                const StudentTotalMarksInp = document.getElementById("StudentTotalMarksInp");
                const StudentCMarksInp = document.getElementById("StudentCMarksInp");
                var StudentCount =  StudentCountInp.value;
                var StudentTotalMarks =  StudentTotalMarksInp.value; 
                var StudentCmarks =  StudentCMarksInp.value;
                // console.log(StudentCount);
                // console.log(StudentTotalMarks);
                // console.log(StudentCmarks);
                GlobStudList = GlobalAllStudList;
                if(!StudentCount) StudentCount = GlobStudList.length;  
                if(StudentCmarks || StudentTotalMarks)
                    GlobStudList =  GlobStudList.filter((value)=> (( StudentCmarks && (value.student_cprogram_marks__c >= StudentCmarks)) || ( StudentTotalMarks && (value.student_marks_scored__c >= StudentTotalMarks)))); 
                GlobStudList = GlobStudList.filter((value)=> ( value.round_one_cleared__c == false && value.isApproved__c == false ));
                GlobStudList = GlobStudList.slice(0,parseInt(StudentCount));
                initTable(GlobStudList,false);  
                // console.log(GlobStudList);
             }  



                document.getElementById('name-down').classList.add('hide-name-down-icon'); 
                document.getElementById('total-marks-down').classList.remove('hide-name-down-icon'); 
                document.getElementById('total-marks-up').classList.add('hide-name-down-icon'); 
                document.getElementById('c-marks-down').classList.add('hide-name-down-icon'); 
                document.getElementById('apti-marks-down').classList.add('hide-name-down-icon');



                function SortArrowClick(ArrowType, SortVar){

                    // console.log(ArrowType  + ' '  + SortVar); 
                        document.getElementById('name-down').classList.add('hide-name-down-icon'); 
                        document.getElementById('total-marks-down').classList.add('hide-name-down-icon'); 
                        document.getElementById('c-marks-down').classList.add('hide-name-down-icon'); 
                        document.getElementById('apti-marks-down').classList.add('hide-name-down-icon');

                        document.getElementById('name-up').classList.remove('hide-name-down-icon'); 
                        document.getElementById('total-marks-up').classList.remove('hide-name-down-icon'); 
                        document.getElementById('c-marks-up').classList.remove('hide-name-down-icon'); 
                        document.getElementById('apti-marks-up').classList.remove('hide-name-down-icon');

                        
                        if(ArrowType === 'up'){
                            StudentSort = (SortVar == 'name') ? 'Name DESC' 
                            :(SortVar == 'total-marks' ? 'total-marks DESC'
                            : (SortVar == 'c-marks' ? 'c-marks DESC'
                            :(SortVar == 'apti-marks' ? 'apti-marks DESC'
                            :'Name ASC'))); 
                            if(SortVar =='name'){
                                document.getElementById('name-up').classList.add('hide-name-down-icon');
                                document.getElementById('name-down').classList.remove('hide-name-down-icon');
                            }else if(SortVar =='total-marks'){
                                document.getElementById('total-marks-up').classList.add('hide-name-down-icon');
                                document.getElementById('total-marks-down').classList.remove('hide-name-down-icon');
                            }else if(SortVar =='c-marks'){
                                document.getElementById('c-marks-up').classList.add('hide-name-down-icon');
                                document.getElementById('c-marks-down').classList.remove('hide-name-down-icon');
                            }else if(SortVar =='apti-marks'){
                                document.getElementById('apti-marks-up').classList.add('hide-name-down-icon');
                                document.getElementById('apti-marks-down').classList.remove('hide-name-down-icon');
                            }

                        }else{
                            StudentSort = (SortVar == 'name') ? 'Name ASC' 
                            :(SortVar == 'total-marks' ? 'total-marks ASC'
                            : (SortVar == 'c-marks' ? 'c-marks ASC'
                            :(SortVar == 'apti-marks' ? 'apti-marks ASC'
                            :'Name ASC')));
                        }



                    if(GlobStudList){
                        if(StudentSort == 'Name ASC'){
                            GlobStudList.sort((a, b) => a.student_id__r.Name.localeCompare(b.student_id__r.Name));
                        }else if(StudentSort == 'Name DESC'){
                            GlobStudList.sort((a, b) => b.student_id__r.Name.localeCompare(a.student_id__r.Name));
                        }else if(StudentSort == 'total-marks ASC'){
                            GlobStudList.sort((a, b) => a.student_marks_scored__c - b.student_marks_scored__c);
                        }else if(StudentSort == 'total-marks DESC' ){
                            GlobStudList.sort((a, b) => b.student_marks_scored__c - a.student_marks_scored__c);
                        }else if(StudentSort == 'c-marks ASC' ){
                            GlobStudList.sort((a, b) => a.student_cprogram_marks__c - b.student_cprogram_marks__c);
                        }else if(StudentSort == 'c-marks DESC' ){
                            GlobStudList.sort((a, b) => b.student_cprogram_marks__c - a.student_cprogram_marks__c);
                        }else if(StudentSort == 'apti-marks ASC' ){
                            GlobStudList.sort((a, b) => a.student_apti_marks__c - b.student_apti_marks__c);
                        }else if(StudentSort == 'apti-marks DESC' ){
                            GlobStudList.sort((a, b) => b.student_apti_marks__c - a.student_apti_marks__c);
                        }
                        initTable(GlobStudList,false);
                    }

                }

                function SearchStudentFn(){
                    var string_to_search = document.getElementById('section-item-3-table-item-heder-row-search-inp-id').value;
                    // console.log(string_to_search);
                    GlobStudList = GlobalAllStudList;
                    if(string_to_search){  
                        GlobStudList =  GlobStudList.filter((value) => ((value.student_id__r.Name.toLowerCase().includes(string_to_search.toLowerCase()) ) || (value.student_id__r.email__c.toLowerCase().includes(string_to_search.toLowerCase()) )));
                    } 
                    initTable(GlobStudList,false);
                }



                function resetStudent(studentEmail,eventID)
                {
                    showLoader(); 
                    
                    Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AltEventListCtrl.resetStudent}',
                        studentEmail,
                        eventID,
                        (result,event)=>{
                            hideLoader();
                            if(result.ErrorMsg != '')
                            {
                                displayErrorMessage(result.ErrorMsg);
                            }
                            else
                            {
                                displaysSuccessMessage("Student Test has been reset!");
                            }
                        }
                    );
                }

                function RefreshBtn(){
                    location.reload(true);
                }

                function ResetAllStudentsFn()
                {
                    var adminId = getUrlParameter('adminId');
                    var eventId = getUrlParameter('eventID');
                    resetAllStudent(adminId,eventID);
                }

                function resetAllStudent(adminId,eventID)
                {
                    showLoader(); 
                    
                    Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AltEventListCtrl.resetAllStudent}',
                        adminId,
                        eventID,
                        (result,event)=>{
                            hideLoader();
                            if(result.ErrorMsg != '')
                            {
                                displayErrorMessage(result.ErrorMsg);
                            }
                            else
                            {
                                displaysSuccessMessage("All Student Test has been reset has been reset!");
                            }
                        }
                    );
                }

                var testIds_promote = []; 
                var promoted_students = [];
                
                function updateUiColor(flag){
                    console.log(testIds_promote);  
                    console.log('updatUI') ;
                    console.log(promoted_students);
                    testIds_promote.map((id)=>{                                    
                                   GlobStudList.map((item,index)=>{
                                    if(item.Id == id){
                                        document.getElementById("section-item-3-table-item-body-row-"+id).style.background = flag ? '#cbc9ff' : 'white';
                                        GlobStudList[index].round_one_cleared__c = flag;
                                    }
                                    
                                  })
                                  promoted_students.map((item,index)=>{
                                    if(item.Id == id){
                                        promoted_students[index].round_one_cleared__c = flag;
                                    }
                                  })
                                   GlobalAllStudList.map((item,index)=>{
                                    if(item.Id == id){
                                         GlobalAllStudList[index].round_one_cleared__c = flag;
                                    }
                                  })
                            })
                            console.log('updatUI after') ;
                           console.log(promoted_students);
                            initTable(GlobStudList,false);
                            document.getElementById('input-all-approved-std-id').checked = false;
                            document.getElementById('input-all-promoted-std-id').checked = false;
                }

                function PromoteStudentsToRound2()
                {
                    showLoader();

                    Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AltEventListCtrl.PromoteStudentsToRoundTwo}',
                        testIds_promote, 
                        function (result, event) {
                            location.reload(true);
                        //    updateUiColor(true);
                           displaysSuccessMessage("Students selected Have been promoted, navigate to Panalists Page!");
                        });
                }

                function DemoteStudentsFromRound2()
                {
                    showLoader();

                    Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AltEventListCtrl.DemoteStudentsFromRoundTwo}',
                        testIds_promote, 
                        function (result, event) {
                        //    updateUiColor(false); 
                           location.reload(true);
                           displaysSuccessMessage("Students selected Have been Demoted"); 
                        });
                }

                function displaysSuccessMessage(warningText) {
                const warningCustom = document.getElementById("sucessCustom");
                const warnText = document.getElementById("alertText"); // Get the warnText element
                const warnImg = document.getElementById("alertImg"); // Get the warnImg element
    
                warningCustom.textContent = ""; // Clear any existing content
                warningCustom.appendChild(warnImg);
    
                // Create a text node and set its content
                const warningTextNode = document.createTextNode("Sucess: " + warningText);
                warningCustom.appendChild(warningTextNode);
    
                warningCustom.appendChild(warnText); // Append the warnText element
    
                warningCustom.style.display = 'flex';
                // warningCustom.classList.add("alert-animation");
                setTimeout(() => {
                    warningCustom.style.display = "none";
                    warningCustom.classList.remove("alert-animation");
                }, 5000);
            }

            function updateGlobalArr(isApprove,ele){
                if(isApprove){
                    for(let i = 0 ; i < GlobalAllStudList.length ; i++){
                        if(GlobalAllStudList[i].Id == ele.getAttribute('data-custom-value')){
                            GlobalAllStudList[i].isApproved__c = true;
                        }
                    }
                    for(let i = 0 ; i < GlobStudList.length ; i++){
                        if(GlobStudList[i].Id == ele.getAttribute('data-custom-value')){
                            GlobStudList[i].isApproved__c = true;
                        }
                    }
                }else{
                    for(let i = 0 ; i < GlobalAllStudList.length ; i++){
                        if(GlobalAllStudList[i].Id == ele.getAttribute('data-custom-value')){
                            GlobalAllStudList[i].isApproved__c = false;
                        }
                    }
                    for(let i = 0 ; i < GlobStudList.length ; i++){
                        if(GlobStudList[i].Id == ele.getAttribute('data-custom-value')){
                            GlobStudList[i].isApproved__c = false;
                        }
                    }
                }
            }

            function compileTest(){
                var eventId = getUrlParameter('eventID');
               showLoader();

                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AltEventListCtrl.compileEventTests}',
                eventId,
                    (result,event)=>{
                    hideLoader();
                        displaysSuccessMessage('Updation In Progress, please refresh after a few minutes.');
                    }
                );
            }

            function changeApproval(studentTestId,eventID,isApproved,ele){
                showLoader();
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AltEventListCtrl.changeApproval}',
                studentTestId,
                eventID,
                isApproved,
                function(result,event){
                    if(event.status){
                        if(isApproved){
                            displaysSuccessMessage("Student has been pushed to the Next Round");
                            document.getElementById('remove-approve-'+ele.getAttribute('data-custom-value')).style.display = 'grid';
                            document.getElementById('approve-'+ele.getAttribute('data-custom-value')).style.display = 'none';
                            document.getElementById('section-item-3-table-item-body-row-'+ele.getAttribute('data-custom-value')).style.background = '#baffba';
                            updateGlobalArr(isApproved,ele);
                        }else{
                            displaysSuccessMessage('Approval Status Changed Successfully');
                            document.getElementById('remove-approve-'+ele.getAttribute('data-custom-value')).style.display = 'none';
                            document.getElementById('approve-'+ele.getAttribute('data-custom-value')).style.display = 'grid';  
                            document.getElementById('section-item-3-table-item-body-row-'+ele.getAttribute('data-custom-value')).style.background = '#ffffff';
                            updateGlobalArr(isApproved,ele);
                        }
                    }
                    else
                    {
                        displayErrorMessage('Something went wrong');
                    }
                    location.reload(true); 
                });
                
            }



            function exportToExcel(){
                showLoader();
                var eventId = getUrlParameter('eventID');
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AltEventListCtrl.getDataForExcel}',
                eventID,
                function(result,event)
                {
                    var StudListNew = [];

                    // console.log(result);
                    
                    for(let i = 0; i < result.length; i++)
                    {
                        var obj = {
                            'Student Name':result[i].student_id__r.Name,
                            'Email' : result[i].student_id__r.email__c,
                            'USN' : result[i].student_id__r.usn__c,
                            'Marks Scored': result[i].student_marks_scored__c,
                            'C Programming Marks': result[i].student_cprogram_marks__c,
                            'Aptitude Marks' : result[i].student_apti_marks__c,
                            'Negative Marks' : result[i].neg_student_marks_scored__c,
                            'Negative C Programming Marks' : result[i].neg_student_cprogram_marks__c,
                            'Negative Aptitude Marks' : result[i].neg_student_apti_marks__c,
                        }
                        StudListNew.push(obj);
                    }

                    var currentdate = new Date(); 
                    var datetime =  currentdate.getDate() + "/"
                                    + (currentdate.getMonth()+1)  + "/" 
                                    + currentdate.getFullYear() + " @ "  
                                    + currentdate.getHours() + ":"  
                                    + currentdate.getMinutes() + ":" 
                                    + currentdate.getSeconds();

                    if(result.length == 0)
                    {
                        displayWarningMessage("No students have been promoted or approved. Cannot Generate Excel");
                        hideLoader();
                        return;
                    }
                    var fileName = result[0].event_id__r.Name + " " + datetime;
                    const ws = XLSX.utils.json_to_sheet(StudListNew);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
                    XLSX.writeFile(wb, fileName + '.xlsx');
                    hideLoader();
                });



            }

            function check_all_student(e){
                if(e.checked){
                    if(promoted_students.length != 0){
                        promoted_students.map((item)=>{
                                document.getElementById('check-'+item.Id).checked = true;
                        })
                    }else{

                        GlobStudList.map((item)=>{
                            if(item.isApproved__c == false && item.round_one_cleared__c == false)
                            document.getElementById('check-'+item.Id).checked = true;
                        })
                    }
                    testIds_promote = GlobStudList.map((item)=>item.Id)
                }else if(!e.checked){
                    if(promoted_students.length != 0){
                        promoted_students.map((item)=>{
                                document.getElementById('check-'+item.Id).checked = false;
                        })
                    }else{
                        GlobStudList.map((item)=>{
                            if(item.isApproved__c == false && item.round_one_cleared__c == false)
                            document.getElementById('check-'+item.Id).checked = false;
                        })
                    }
                    testIds_promote = [];
                }
                // console.log(testIds_promote);

            }

            function check_single_student(e){
                if(!e.checked){
                    testIds_promote = testIds_promote.filter((item)=> item != e.getAttribute('data-custom-value'));
                }else{
                    testIds_promote.push(e.getAttribute('data-custom-value'));
                }
                // console.log(testIds_promote);
            }

            

            function veiw_all_promoted_students(e){ 
                console.log('promoted_students');
                console.log(promoted_students);
                   if(e.checked){
                      GlobStudList.forEach(item => {
                        if(item.round_one_cleared__c == true){
                              promoted_students.push(item)
                        }
                      });
                      if(promoted_students.length == 0) displayWarningMessage("No Promoted Students To Display");
                      initTable(promoted_students, true);
                   }else if(!e.checked){
                        promoted_students = promoted_students.filter((item)=> item.round_one_cleared__c != true)
                        if(promoted_students.length  != 0)
                            initTable(promoted_students,true);
                    }
                    if( promoted_students.length == 0){
                        // displayWarningMessage("there are no promoted students display");
                        initTable(GlobStudList,false);
                    }
                    testIds_promote = [];   
            }

            function veiw_all_approved_students(e){
                   if(e.checked){
                        GlobStudList.forEach(item => {
                            if(item.isApproved__c == true){
                                promoted_students.push(item);
                            }
                        });
                      if(promoted_students.length == 0) displayWarningMessage("No Approved Students To Display");
                      initTable(promoted_students,true);
                   }else if(!e.checked ){
                        promoted_students = promoted_students.filter((item)=> item.isApproved__c != true);
                        if(promoted_students.length != 0)
                            initTable(promoted_students,true);
                   }
                   if( promoted_students.length == 0){
                    // displayWarningMessage("there are no approved students to display");
                        initTable(GlobStudList,false);
                    }
                    testIds_promote = [];
            }

            function getStudentAssessment(studentData)
            {
                var studentID = [];
                studentIDs = studentData.map(item => { return item.Id}) 
                console.log(studentIDs);
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AltEventListCtrl.getStudentAssessment}',
                studentIDs,
                function(result,event)
                {
                    console.log(result);
                    studentAssessmentsMap = result;
                    initTable(studentData);
                }
                );
            }

            function checkIfInterviewDone(studentID)
            {
                if(studentAssessmentsMap === undefined)
                {
                    return false;
                }

                var panelID = getUrlParameter('panelistId');
                var assementsList = studentAssessmentsMap[studentID];
                
                if(assementsList === null || assementsList === undefined) 
                {
                    return false;
                }

                for(let i = 0; i < assementsList.length; i++)
                {
                    if(assementsList[i].panelistId == panelID)
                    {
                        console.log(assementsList[i].studentStatus);
                        return assementsList[i].studentStatus;
                    }
                }


                return false;
            }

           
        </script>
    </body>
</apex:page>